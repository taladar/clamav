From 1e7ec05f6e9cf571b5cd082ac9c9110532b541b9 Mon Sep 17 00:00:00 2001
From: Steven Morgan <stevmorg@cisco.com>
Date: Wed, 1 Nov 2017 16:23:23 -0400
Subject: bb11944 - fix possible message.c OOB read.

Patch-Name: bb11944-fix-possible-message.c-OOB-read.patch
---
 libclamav/message.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/libclamav/message.c b/libclamav/message.c
index 8afe800..59d92f7 100644
--- a/libclamav/message.c
+++ b/libclamav/message.c
@@ -2323,15 +2323,16 @@ rfc2231(const char *in)
 						in++;
 						continue;
 					}
-					*p = '\0';
 					break;
 				case '=':
 					/*strcpy(p, in);*/
 					strcpy(p, "=rfc2231failure");
+                                        p += strlen ("=rfc2231failure");
 					break;
 			}
 			break;
 		} while(*in);
+                *p = '\0';
 
 		cli_dbgmsg("RFC2231 parameter continuations are not yet handled, returning \"%s\"\n",
 			ret);
